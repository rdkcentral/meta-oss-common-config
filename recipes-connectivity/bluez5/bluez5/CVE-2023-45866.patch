Date: Oct 10, 2023
From: 25a471a83e02e1effb15d5a488b3f0085eaeb675
Author: Luiz Augusto von Dentz
Subject: Patch bluez5 to address CVE-2023-45866
Source:  kernel.org https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/?id=25a471a83e02e1effb15d5a488b3f0085eaeb675
Upstream-Status: Available from 5.71
Signed-off-by: Srikanth Simgamsetti <srikanth_simgamsetti@comcast.com>

Index: bluez-5.48/profiles/input/device.c
===================================================================
--- bluez-5.48.orig/profiles/input/device.c
+++ bluez-5.48/profiles/input/device.c
@@ -95,7 +95,7 @@ struct input_device {
 
 static int idle_timeout = 0;
 static bool uhid_enabled = false;
-static bool br_bonded_only = false;
+static bool br_bonded_only = true;
 
 void input_set_idle_timeout(int timeout)
 {
Index: bluez-5.48/profiles/input/input.conf
===================================================================
--- bluez-5.48.orig/profiles/input/input.conf
+++ bluez-5.48/profiles/input/input.conf
@@ -17,5 +17,5 @@
 # platforms may want to make sure that input connections only come from bonded
 # device connections. Several older mice have been known for not supporting
 # pairing/encryption.
-# Defaults to false to maximize device compatibility.
+# Defaults to true for security.
 # BrBondedOnly=true
